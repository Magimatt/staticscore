{% extends 'base.html' %}


{% block head %}
<title>StaticScore Search Results</title>

{% endblock %}


{% block body %}
<table style="width:40%;margin-left:auto;margin-right:auto;">
  <caption>Search results for: {{ search_text }}</caption>
  <tr>
    <th>POSTER</th>
    <th>TITLE</th>
    <th>RELEASE DATE</th>
    <th>VOTE</th>
  </tr>
  {% for movie in results %}
  <tr>
    <td>
      {% if movie['poster_path'] == None %}
        {% set poster_path = url_for('static', filename='assets/no_image.png') %}
      {% else %}
        {% set poster_path = "https://image.tmdb.org/t/p/w500" + movie['poster_path'] %}
      {% endif %}
    <a href="https://www.themoviedb.org/movie/{{ movie['id'] }}-{{ movie['title'] }}" >
      <img
        src="{{ poster_path }}"
        style="height:220px;border-radius:5%;"
        class="poll"
      />
    </a>
    </td>
    <td>
      <a href=""https://www.themoviedb.org/movie/{{ movie['id'] }}-{{ movie['title'] }}">"{{ movie['title'] }}</a>
    </td>
    <td>{{ movie['release_date'] }}</td>
    <td>
      {% set form_action = "/vote" if movie['user_vote'] == None else "/update" %}
      <form action="{{ form_action }}" method="POST">
        <input
          type="hidden"
          id="movietitle-{{ movie['id'] }}"
          name="movie-title"
          value="{{ movie['title'] }}"
        />
        <input
          type="hidden"
          id="movieid-{{ movie['id'] }}"
          name="movie-id"
          value="{{ movie['id'] }}"
        />
        <input
          type="hidden"
          id="movieid-{{ movie['release_date'] }}"
          name="movie-release-date"
          value="{{ movie['release_date'] }}"
        />
        <input
          type="hidden"
          id="movieid-{{ movie['poster_path'] }}"
          name="movie-poster-path"
          value="{{ movie['poster_path'] }}"
        />
        <div style="float:left;" class="poll">Posi-score<br/><!-- use a "radio button" electron shaped option instead -->
          <input
            type="text"
            id="ps-{{ movie['id'] }}"
            name="ps-vote"
            style="width:20px"
            {% set vote_value = "" if movie['user_vote'] == None else movie['user_vote'].posiscore %}
            value="{{ vote_value }}"
          ><br/>Nega-score<br/><!-- use a "radio button" electron shaped option instead -->
          <input
            type="text"
            id="ns-{{ movie['id'] }}"
            name="ns-vote"
            style="width:20px"
            {% set vote_value = "" if movie['user_vote'] == None else movie['user_vote'].negascore %}
            value="{{ vote_value }}"
          ><br/>
        </div>
        <div style="float:right;" class="poll">
          <input
            type="submit"
            {% set submit_text = "Vote!" if movie['user_vote'] == None else "Update!" %}
            value="{{ submit_text }}"
            id="vote-{{ movie['id'] }}"
            name="vote"
          >
        </div>
      </form>
    </td>
  </tr>
{% endfor %}
</table>

{% endblock %}